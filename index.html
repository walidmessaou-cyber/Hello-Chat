<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello, Future Me - Interview</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: linear-gradient(135deg, #F7F5F2 0%, #FFFFFF 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .chat-container {
            width: 100%;
            max-width: 800px;
            height: 90vh;
            max-height: 800px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-header {
            background: #FFE566;
            padding: 30px;
            text-align: center;
            border-bottom: 2px solid #2D2D2D;
        }

        .chat-header h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 32px;
            font-weight: 600;
            color: #1A1A1A;
            margin-bottom: 8px;
        }

        .chat-header p {
            color: #2D2D2D;
            font-size: 14px;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .message {
            display: flex;
            gap: 12px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.assistant {
            align-self: flex-start;
        }

        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .message.assistant .message-avatar {
            background: #FFE566;
        }

        .message.user .message-avatar {
            background: #2D2D2D;
            color: white;
        }

        .message-content {
            max-width: 70%;
            padding: 16px 20px;
            border-radius: 16px;
            line-height: 1.6;
            font-size: 15px;
        }

        .message.assistant .message-content {
            background: #F7F5F2;
            color: #1A1A1A;
            border-bottom-left-radius: 4px;
        }

        .message.user .message-content {
            background: #2D2D2D;
            color: white;
            border-bottom-right-radius: 4px;
        }

        .chat-input-container {
            padding: 20px 30px;
            border-top: 1px solid #F7F5F2;
            background: white;
        }

        .chat-input-wrapper {
            display: flex;
            gap: 12px;
        }

        .chat-input {
            flex: 1;
            padding: 14px 20px;
            border: 2px solid #F7F5F2;
            border-radius: 12px;
            font-family: 'DM Sans', sans-serif;
            font-size: 15px;
            outline: none;
            transition: all 0.2s;
        }

        .chat-input:focus {
            border-color: #FFE566;
        }

        .send-button {
            padding: 14px 30px;
            background: #2D2D2D;
            color: white;
            border: none;
            border-radius: 12px;
            font-family: 'DM Sans', sans-serif;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .send-button:hover:not(:disabled) {
            background: #1A1A1A;
            transform: translateY(-1px);
        }

        .send-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .typing-indicator {
            display: flex;
            gap: 6px;
            padding: 16px 20px;
            background: #F7F5F2;
            border-radius: 16px;
            border-bottom-left-radius: 4px;
            width: fit-content;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #2D2D2D;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.7;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 12px 20px;
            border-radius: 8px;
            margin: 10px 30px;
            font-size: 14px;
        }

        /* Scrollbar styling */
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #F7F5F2;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #FFE566;
            border-radius: 3px;
        }

        @media (max-width: 768px) {
            .chat-container {
                height: 100vh;
                max-height: 100vh;
                border-radius: 0;
            }

            .message-content {
                max-width: 85%;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <h1>ðŸ‘‹ Hello, Future Me</h1>
            <p>Let's write your story. The real one.</p>
        </div>

        <div class="chat-messages" id="chatMessages">
            <!-- Messages will be inserted here -->
        </div>

        <div class="chat-input-container">
            <div class="chat-input-wrapper">
                <input 
                    type="text" 
                    class="chat-input" 
                    id="chatInput" 
                    placeholder="Type your answer here..."
                    autocomplete="off"
                >
                <button class="send-button" id="sendButton">Send</button>
            </div>
        </div>
    </div>

    <script>
        // Your n8n webhook URL
        const WEBHOOK_URL = 'https://n8n.French-GCSE.com/webhook/11cd9364-b3aa-48b3-9d4c-9f1fb40cb9da/chat';
        
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const sendButton = document.getElementById('sendButton');
        
        let sessionId = generateSessionId();
        let isWaitingForResponse = false;

        // Generate unique session ID
        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        // Add message to chat
        function addMessage(text, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'assistant'}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = isUser ? 'ðŸ‘¤' : 'ðŸ’­';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.textContent = text;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            chatMessages.appendChild(messageDiv);
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Show typing indicator
        function showTyping() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message assistant';
            typingDiv.id = 'typingIndicator';
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = 'ðŸ’­';
            
            const typingContent = document.createElement('div');
            typingContent.className = 'typing-indicator';
            typingContent.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
            
            typingDiv.appendChild(avatar);
            typingDiv.appendChild(typingContent);
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Remove typing indicator
        function hideTyping() {
            const typing = document.getElementById('typingIndicator');
            if (typing) typing.remove();
        }

        // Show error
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            document.querySelector('.chat-input-container').insertBefore(
                errorDiv, 
                document.querySelector('.chat-input-wrapper')
            );
            setTimeout(() => errorDiv.remove(), 5000);
        }

        // Send message to n8n
        async function sendMessage(message) {
            if (!message.trim() || isWaitingForResponse) return;
            
            // Disable input
            isWaitingForResponse = true;
            chatInput.disabled = true;
            sendButton.disabled = true;
            
            // Add user message
            addMessage(message, true);
            chatInput.value = '';
            
            // Show typing
            showTyping();
            
            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'sendMessage',
                        sessionId: sessionId,
                        chatInput: message
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                hideTyping();
                
                // Add assistant response
                if (data.output) {
                    addMessage(data.output);
                } else {
                    throw new Error('No response from assistant');
                }
                
            } catch (error) {
                console.error('Error:', error);
                hideTyping();
                showError('Oops! Something went wrong. Try again?');
            } finally {
                // Re-enable input
                isWaitingForResponse = false;
                chatInput.disabled = false;
                sendButton.disabled = false;
                chatInput.focus();
            }
        }

        // Load initial message
        function loadInitialMessage() {
            const greeting = `Hi, I'm Lola. I'm going to write your Future Journal â€” the diary of the version of you who actually did the thing.

Not some generic story. Your story. Your struggles, your comebacks, your life.

By the end, you won't just read about change â€” you'll recognize yourself in it.

To make it real, I need to ask you some questions. About your goal, your life, your chaos. The more you give me, the more this thing comes alive.

This is going to be good.

Ready?`;
            
            addMessage(greeting);
        }

        // Event listeners
        sendButton.addEventListener('click', () => {
            sendMessage(chatInput.value);
        });

        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage(chatInput.value);
            }
        });

        // Load initial message on page load
        window.addEventListener('load', () => {
            loadInitialMessage();
        });
    </script>
</body>
</html>
